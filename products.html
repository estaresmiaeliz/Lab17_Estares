<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manage Products - Product Management Dashboard</title>
    <!-- Load Tailwind CSS for modern, responsive styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom styles for the dashboard structure */
        .sidebar {
            width: 16rem; /* Equivalent to col-lg-2, col-md-3 */
            min-height: 100vh;
            position: fixed;
            z-index: 10;
            top: 0;
            left: 0;
            transition: transform 0.3s ease-in-out;
            transform: translateX(-16rem); /* Hidden by default on mobile */
        }
        .main-content {
            padding-left: 0;
        }
        @media (min-width: 768px) {
            .sidebar {
                transform: translateX(0); /* Always visible on desktop */
            }
            .main-content {
                padding-left: 16rem; /* Offset for the fixed sidebar */
            }
            .sidebar-toggle-btn {
                display: none;
            }
        }
        .sidebar.open {
            transform: translateX(0);
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800 font-sans">
    
    <!-- Navbar (Fixed Top Bar) -->
    <nav class="fixed top-0 left-0 right-0 z-20 bg-blue-700 shadow-lg flex items-center justify-between p-3 h-14 main-content md:p-0 md:pl-64">
        <button id="sidebar-toggle" class="sidebar-toggle-btn text-white md:hidden p-2 rounded-md hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-400">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-menu"><line x1="4" x2="20" y1="12" y2="12"/><line x1="4" x2="20" y1="6" y2="6"/><line x1="4" x2="20" y1="18" y2="18"/></svg>
        </button>
        
        <div class="hidden md:block absolute left-0 h-14 flex items-center px-4 bg-blue-800 w-64">
            <a class="text-xl font-bold text-white tracking-wider" href="#">Company Name</a>
        </div>

        <div class="flex-grow flex justify-center md:justify-start ml-0 md:ml-4">
            <h4 class="text-white text-base font-medium">Welcome back, Admin!</h4>
        </div>
        
        <a class="text-white text-sm font-medium hover:text-blue-200 transition duration-150 p-2 rounded-md" href="#">
            Sign out
        </a>
    </nav>

    <!-- Sidebar (Left Navigation) -->
    <div id="sidebarMenu" class="sidebar bg-gray-900 text-white shadow-xl flex flex-col pt-14 md:pt-0">
        <div class="pt-4 px-4 flex-grow">
            <ul class="space-y-2">
                <li class="rounded-lg">
                    <a class="flex items-center p-3 text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white rounded-lg transition duration-150" href="#">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-home mr-3"><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></svg>
                        Dashboard
                    </a>
                </li>
                <!-- PRODUCTS LINK (Active) -->
                <li class="rounded-lg bg-blue-600">
                    <a class="flex items-center p-3 text-sm font-semibold text-white rounded-lg" href="#">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-package mr-3"><path d="m7.5 4.27 9 5.15"/><path d="m21 8-9-5-9 5"/><path d="m3 12.73 9 5.15 9-5.15"/><path d="M12 22V10"/></svg>
                        Products (Current)
                    </a>
                </li>
                <!-- ORDERS LINK (Links to the file you just created) -->
                <li class="rounded-lg">
                    <a class="flex items-center p-3 text-sm font-medium text-gray-300 hover:bg-gray-700 hover:text-white rounded-lg transition duration-150" href="orders.html">
                        <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clipboard-list mr-3"><rect width="8" height="4" x="8" y="2" rx="1" ry="1"/><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/><path d="M12 11h4"/><path d="M12 15h4"/><path d="M8 11h.01"/><path d="M8 15h.01"/></svg>
                        Orders
                    </a>
                </li>
            </ul>
        </div>
    </div>

    <!-- Main Content Area (Products Table) -->
    <main class="main-content pt-16 md:pt-4 p-4 md:p-8">
        <div class="max-w-7xl mx-auto">
            <!-- Header and Actions -->
            <div class="flex flex-col md:flex-row justify-between items-start md:items-center pb-4 mb-4 border-b border-gray-200">
                <h1 class="text-3xl font-extrabold text-gray-900 mb-4 md:mb-0">Manage Products</h1>
                <a href="#" class="flex items-center px-4 py-2 bg-green-600 text-white font-medium text-sm rounded-lg shadow-md hover:bg-green-700 transition duration-150">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-plus-square mr-2"><rect width="18" height="18" x="3" y="3" rx="2"/><path d="M12 8v8"/><path d="M8 12h8"/></svg>
                    New Product
                </a>
            </div>

            <!-- Products Table -->
            <div class="bg-white rounded-xl shadow-lg overflow-x-auto">
                <table class="min-w-full divide-y divide-gray-200">
                    <thead class="bg-gray-100">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">#</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Code</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Name</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Price (PHP)</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Stocks</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Actions</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-200">
                        <tr class="hover:bg-gray-50 transition duration-150">
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">1</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">CLQ-001</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Celeteque Hydration Facial Wash</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">150.00</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">350</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                <div class="flex space-x-2">
                                    <button class="flex items-center justify-center w-8 h-8 rounded-full bg-blue-500 text-white hover:bg-blue-600 transition duration-150" title="Edit">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-pencil"><path d="M17 3a2.85 2.85 0 0 0-4 0L7 13v4h4l10-10a2.85 2.85 0 0 0 0-4Z"/><path d="M14 7l-4 4"/></svg>
                                    </button>
                                    <button onclick="showModal('CLQ-001')" class="flex items-center justify-center w-8 h-8 rounded-full bg-red-500 text-white hover:bg-red-600 transition duration-150" title="Delete">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-trash-2"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg>
                                    </button>
                                </div>
                            </td>
                        </tr>
                        <tr class="bg-gray-50 hover:bg-gray-100 transition duration-150">
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">2</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">CLQ-002</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Celeteque Hydration Alcohol-Free Toner</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">175.00</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">210</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                <div class="flex space-x-2">
                                    <button class="flex items-center justify-center w-8 h-8 rounded-full bg-blue-500 text-white hover:bg-blue-600 transition duration-150" title="Edit">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-pencil"><path d="M17 3a2.85 2.85 0 0 0-4 0L7 13v4h4l10-10a2.85 2.85 0 0 0 0-4Z"/><path d="M14 7l-4 4"/></svg>
                                    </button>
                                    <button onclick="showModal('CLQ-002')" class="flex items-center justify-center w-8 h-8 rounded-full bg-red-500 text-white hover:bg-red-600 transition duration-150" title="Delete">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-trash-2"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg>
                                    </button>
                                </div>
                            </td>
                        </tr>
                        <tr class="hover:bg-gray-50 transition duration-150">
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900">3</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">CLQ-003</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">Celeteque Hydration Moisturizer</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">220.00</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-500">180</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium">
                                <div class="flex space-x-2">
                                    <button class="flex items-center justify-center w-8 h-8 rounded-full bg-blue-500 text-white hover:bg-blue-600 transition duration-150" title="Edit">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-pencil"><path d="M17 3a2.85 2.85 0 0 0-4 0L7 13v4h4l10-10a2.85 2.85 0 0 0 0-4Z"/><path d="M14 7l-4 4"/></svg>
                                    </button>
                                    <button onclick="showModal('CLQ-003')" class="flex items-center justify-center w-8 h-8 rounded-full bg-red-500 text-white hover:bg-red-600 transition duration-150" title="Delete">
                                        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-trash-2"><path d="M3 6h18"/><path d="M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6"/><path d="M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2"/><line x1="10" x2="10" y1="11" y2="17"/><line x1="14" x2="14" y1="11" y2="17"/></svg>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </main>
    
    <!-- Custom Modal for Delete Confirmation (Replaces alert/confirm) -->
    <div id="deleteModal" class="fixed inset-0 bg-gray-600 bg-opacity-75 hidden flex items-center justify-center z-50">
        <div class="bg-white rounded-xl shadow-2xl p-6 w-11/12 max-w-sm">
            <h3 class="text-xl font-bold mb-4 text-red-600">Confirm Deletion</h3>
            <p id="modal-message" class="mb-6 text-gray-700">Are you sure you want to delete product <span id="product-code-display" class="font-bold"></span>?</p>
            <div class="flex justify-end space-x-3">
                <button onclick="hideModal()" class="px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition duration-150">Cancel</button>
                <button onclick="handleDeleteConfirm()" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition duration-150">Delete</button>
            </div>
        </div>
    </div>


    <script type="module">
        // Firebase Imports
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously, signInWithCustomToken, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, setLogLevel } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Global Firebase Variables (Mandatory)
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;

        let app, db, auth;
        let userId = null;
        let isAuthReady = false;
        
        let productToDelete = null;

        // --- Firebase Initialization and Auth ---
        window.onload = async () => {
            try {
                setLogLevel('Debug');
                
                app = initializeApp(firebaseConfig);
                db = getFirestore(app);
                auth = getAuth(app);

                // Handle authentication
                onAuthStateChanged(auth, async (user) => {
                    if (user) {
                        userId = user.uid;
                        console.log("Authenticated user ID:", userId);
                    } else if (initialAuthToken) {
                        await signInWithCustomToken(auth, initialAuthToken);
                    } else {
                        const anonymousUser = await signInAnonymously(auth);
                        userId = anonymousUser.user.uid;
                        console.log("Signed in anonymously. User ID:", userId);
                    }
                    isAuthReady = true;
                });

            } catch (error) {
                console.error("Firebase Initialization Error:", error);
            }
        };

        // --- UI Logic for Delete Modal ---
        window.showModal = (productCode) => {
            productToDelete = productCode;
            document.getElementById('product-code-display').textContent = productCode;
            document.getElementById('deleteModal').classList.remove('hidden');
        }

        window.hideModal = () => {
            document.getElementById('deleteModal').classList.add('hidden');
            productToDelete = null;
        }

        window.handleDeleteConfirm = () => {
            if (productToDelete) {
                console.log(`[ACTION] Deleting product with code: ${productToDelete}. Firestore logic would go here.`);
                alertMessage(`Product ${productToDelete} successfully marked for deletion.`);
                hideModal();
            }
        }
        
        // Simple message box (replaces alert)
        window.alertMessage = (message) => {
            const tempModal = document.createElement('div');
            tempModal.className = 'fixed inset-0 bg-gray-600 bg-opacity-75 flex items-center justify-center z-50';
            tempModal.innerHTML = `
                <div class="bg-white rounded-xl shadow-2xl p-6 w-11/12 max-w-sm">
                    <h3 class="text-xl font-bold mb-4 text-blue-600">System Message</h3>
                    <p class="mb-6 text-gray-700">${message}</p>
                    <div class="flex justify-end">
                        <button onclick="this.closest('.fixed').remove()" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition duration-150">OK</button>
                    </div>
                </div>
            `;
            document.body.appendChild(tempModal);
        }

        // Sidebar toggle logic for mobile
        const sidebar = document.getElementById('sidebarMenu');
        const toggleBtn = document.getElementById('sidebar-toggle');

        toggleBtn.addEventListener('click', () => {
            sidebar.classList.toggle('open');
        });

    </script>
</body>
</html>